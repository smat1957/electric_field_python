import numpy as np
import matplotlib.pyplot as plt
# 電位分布の実験より、電流の大きさと方向の作図
Z1 = np.array(
        [[3.52,3.48,3.32,3.12,2.76,2.54,2.43],
        [3.58,3.51,3.30,2.90,2.52,2.31,2.22],
        [3.78,3.85,3.47,2.97,2.36,1.92,1.97],
        [3.91,5.00,3.56,2.95,2.21,0.00,1.80],
        [3.77,3.85,3.47,2.96,2.45,1.96,2.00],
        [3.56,3.50,3.28,2.96,2.62,2.32,2.23],
        [3.44,3.33,3.20,2.99,2.75,2.54,2.44]])
Z2 = np.array(
        [[4.47,4.65,4.14,2.90,1.60,0.87,1.08],
        [4.45,4.65,4.11,2.93,1.64,0.88,1.10],
        [4.39,4.63,4.14,2.89,1.65,0.96,1.21],
        [4.24,4.40,4.04,2.90,1.85,1.24,1.42],
        [3.99,3.96,3.56,2.83,2.15,1.77,1.66],
        [3.78,3.62,3.30,2.83,2.37,2.06,1.92],
        [3.57,3.44,3.16,2.85,2.46,2.18,2.01]])
Z3 = np.array(
        [[0.76,0.52,0.31,0.065,-0.19,-0.41,-0.58],
        [0.88,0.61,0.36,0.00,-0.24,-0.52,-0.68],
        [1.10,0.87,0.53,0.081,-0.039,-0.013,-0.96],
        [1.66,1.46,0.928,0.17,-0.54,-1.06,-1.23],
        [2.24,2.31,1.35,1.49,-1.02,-2.06,-1.83],
        [2.72,5.00,1.84,1.61,-1.42,-5.0,-2.14],
        [2.3,2.35,1.46,0.3,-0.78,-1.62,-1.65]])
Z=Z1
X, Y = np.mgrid[10:125:20, 10:125:20]
U,V=[],[]
for j in range(len(Z)-1):
  for i in range(Z[j].size-1):
    x, y = -(Z[j][i+1] - Z[j][i]), -(Z[j+1][i+1] - Z[j][i+1])
    U.append(x)
    V.append(y)

plt.title('Electric Field (1)',size=14)
plt.xlabel('X', size=14)
plt.ylabel('Y', size=14)
plt.xlim(0,120)
plt.ylim(0,120)
plt.quiver(Y, X, U, V, units='width', color='blue')
plt.grid()
plt.savefig('Efield1.png')
plt.show()

